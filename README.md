# aws-greengrass-docker-builds

Multi-architecture Docker images of **AWS IoT Greengrass Nucleus**  
— automatically built from the **latest version of the
[`aws-greengrass/aws-greengrass-docker`](https://github.com/aws-greengrass/aws-greengrass-docker) context** and
published to GitHub Container Registry (GHCR).

| Status | Schedule | Context tag | Architectures |
|--------|----------|-------------|---------------|
| ![CI badge](https://github.com/aslafy-z/aws-greengrass-docker-builds/actions/workflows/build-daily.yml/badge.svg) | Daily 03:30 UTC + manual | _Latest version in_ **aws-greengrass-docker** | `linux/amd64`, `linux/arm64` |

---

## What you get

* **Always-current images** – the newest patch (e.g. `2.14.3`) for *every* minor line (`2.14.x`, `2.13.x`, …) are rebuilt every day when AWS publishes fixes.  
* **Multi-arch** – AMD64 (Intel/AMD), ARM64 (Apple Silicon, graviton).  
* **OCI-labelled packages** – images show rich metadata (version, repo URL, commit SHA) in GHCR.  
* **On-demand builds** – a manual workflow lets you specify _any_ combination of Greengrass Nucleus and Greengrass Nucleus Docker refs.

---

## Pulling an image

```bash
docker pull ghcr.io/aslafy-z/aws-greengrass-docker-builds/greengrass-nucleus:2.14.3-dockerf745fdecba31c8903da6494a0ceeca78e497e041
````

Tag pattern:

```
<greengrassNucleusVersion>-docker<greengrassDockerVersion>
```

Example: `2.14.3-dockerf745fdecba31c8903da6494a0ceeca78e497e041`

---

## Workflows

| File                                             | Purpose                                                         | Trigger         | Tags produced                                 |
| ------------------------------------------------ | --------------------------------------------------------------- | --------------- | --------------------------------------------- |
| **`build-image.yml`**                            | Canonical builder (reusable workflow)                           | `workflow_call` | see caller                                    |
| **`build-daily.yml`**                            | Build latest context × latest Nucleus patches (parallel matrix) | Cron + manual   | `<greengrassNucleusVersion>-docker<latestGreengrassDockerVersion>` |
| **`build-custom.yml`**                           | Build any versions you type into the dispatch form              | Manual          | `<chosenGreengrassNucleusVersion>-docker<chosenGreengrassDockerVersion>` |

### How tags are chosen

1. **Docker context** – latest working version in `aws-greengrass-docker` (`f745fdecba31c8903da6494a0ceeca78e497e041` as of 2025-05-07).
2. **Greengrass Nucleus** – newest *patch* of every minor line scraped from upstream releases.
3. Tags and OCI labels are generated by [`docker/metadata-action`](https://github.com/docker/metadata-action).

---

## License

This repository’s workflow code is MIT-licensed.
The resulting container images include AWS Greengrass binaries which are licensed under the AWS IoT Greengrass license terms.
